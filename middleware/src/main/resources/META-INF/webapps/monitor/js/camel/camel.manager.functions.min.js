var baseUrl,urlTree,urlRoute,urlContext;var urlContextStart,urlContextStop,urlContextCLReset,urlRouteStart,urlRouteStop,urlRouteReset,urlRouteXml;var urlLogsXml,urlContextLogsXml,urlRouteLogContent,urlContextLogContent;var urlRouteDBLogs,urlContextDBLogs,urlScriptsList,urlGetScriptContent;var urlGetInfos,urlSetLogLevel,urlDBWebConsole,urlRouteAdd;var urlAcknowledge,urlAcknowledgeAll,urlActiveMQQueuesList,urlActiveMQQueue;var urlActiveMQQueueRemove,urlActivemqBrokerDeleteMessages,urlScriptUpload;var urlSaveContextBeans,urlGetContextBeans,urlGetContextProperties,urlSaveContextProperties;var urlActiveMQTopicsList,urlActiveMQTopic,urlActiveMQTopicRemove,urlActiveMQAddSubscriber,urlActiveMQRemoveMessage,urlActiveMQAddTopic,urlActiveMQRemoveSubscriber,urlAddContext;var fadeOutTime=250;var userRoles,divQuestion,internalDBActive,internalActiveMQActive;var urlContextDirectory,urlDownloadContextFile,urlRemoveContextFile;function setInternalDBActive(a){internalDBActive=a}function setInternalActiveMQActive(a){internalActiveMQActive=a}function initUrls(a){baseUrl=document.location.protocol+"//"+getURLParameter("camelIP",getURLIP())+":"+a;urlTree=baseUrl+"/manager/tree?key="+getKey()+"&responseType=json&callback=?";urlRoute=baseUrl+"/manager/routeAttributes?key="+getKey()+"&responseType=json";urlContext=baseUrl+"/manager/contextAttributes?key="+getKey()+"&responseType=json";urlContextStart=baseUrl+"/manager/contextStart?key="+getKey()+"&responseType=json";urlContextStop=baseUrl+"/manager/contextStop?key="+getKey()+"&responseType=json";urlContextCLReset=baseUrl+"/manager/contextCLReset?key="+getKey()+"&responseType=json";urlRouteStart=baseUrl+"/manager/routeStart?key="+getKey()+"&responseType=json";urlRouteStop=baseUrl+"/manager/routeStop?key="+getKey()+"&responseType=json";urlRouteReset=baseUrl+"/manager/routeReset?key="+getKey()+"&responseType=json";urlRouteXml=baseUrl+"/manager/routeXml?key="+getKey();urlLogsXml=baseUrl+"/manager/getRouteLogs?key="+getKey()+"&responseType=json";urlContextLogsXml=baseUrl+"/manager/getContextLogs?key="+getKey()+"&responseType=json";urlRouteLogContent=baseUrl+"/manager/getRouteLogContent?key="+getKey();urlContextLogContent=baseUrl+"/manager/getContextLogContent?key="+getKey();urlRouteDBLogs=baseUrl+"/manager/getDBLogs?key="+getKey()+"&responseType=json";urlContextDBLogs=baseUrl+"/manager/getContextDBLogs?key="+getKey()+"&responseType=json";urlScriptsList=baseUrl+"/manager/getScriptsList?key="+getKey()+"&responseType=json";urlGetScriptContent=baseUrl+"/manager/getScriptContent?key="+getKey();urlGetInfos=baseUrl+"/manager/getInfos?key="+getKey()+"&responseType=json&callback=?";urlSetLogLevel=baseUrl+"/manager/setLogLevel?key="+getKey()+"&responseType=json";urlDBWebConsole=baseUrl+"/manager/webConsole?key="+getKey();urlRouteAdd=baseUrl+"/manager/routeAdd?key="+getKey()+"&responseType=json";urlAcknowledge=baseUrl+"/manager/acknowledge?key="+getKey();urlAcknowledgeAll=baseUrl+"/manager/acknowledgeall?key="+getKey()+"&responseType=json";urlActiveMQQueuesList=baseUrl+"/manager/activemqQueuesList?key="+getKey()+"&responseType=json&callback=?";urlActiveMQQueue=baseUrl+"/manager/activemqQueue?key="+getKey()+"&responseType=json&callback=?";urlActiveMQQueueRemove=baseUrl+"/manager/activemqQueueRemove?key="+getKey()+"&responseType=json&callback=?";urlActivemqBrokerDeleteMessages=baseUrl+"/manager/activemqBrokerDeleteMessages?key="+getKey()+"&responseType=json&callback=?";urlActiveMQTopicsList=baseUrl+"/manager/activemqTopicsList?key="+getKey()+"&responseType=json&callback=?";urlActiveMQTopic=baseUrl+"/manager/activemqTopic?key="+getKey()+"&responseType=json&callback=?";urlActiveMQTopicRemove=baseUrl+"/manager/activemqTopicRemove?key="+getKey()+"&responseType=json&callback=?";urlActiveMQAddSubscriber=baseUrl+"/manager/activemqAddSubcriber?key="+getKey()+"&responseType=json&callback=?";urlActiveMQAddTopic=baseUrl+"/manager/activemqAddTopic?key="+getKey()+"&responseType=json&callback=?";urlActiveMQRemoveMessage=baseUrl+"/manager/activemqQueueRemoveMessage?key="+getKey()+"&responseType=json&callback=?";urlActiveMQRemoveSubscriber=baseUrl+"/manager/activemqRemoveSubscriber?key="+getKey()+"&responseType=json&callback=?";urlScriptUpload=baseUrl+"/manager/scriptUpload?key="+getKey()+"&responseType=json";urlAddContext=baseUrl+"/manager/addContext?key="+getKey()+"&responseType=json&callback=?";urlGetContextBeans=baseUrl+"/manager/getContextBeans?key="+getKey()+"&responseType=json";urlSaveContextBeans=baseUrl+"/manager/saveContextBeans?key="+getKey()+"&responseType=json";urlGetContextProperties=baseUrl+"/manager/getContextProperties?key="+getKey()+"&responseType=json";urlSaveContextProperties=baseUrl+"/manager/saveContextProperties?key="+getKey()+"&responseType=json";urlContextDirectory=baseUrl+"/manager/listContextDirectory?key="+getKey();urlDownloadContextFile=baseUrl+"/manager/downloadContextFile";urlRemoveContextFile=baseUrl+"/manager/removeContextFile"}function createScriptsListTable(e){function a(i,h){var g=checkLength(i,"File's name",8,20);var f=g&&checkRegexp(i,/^([a-zA-Z0-9])*(\.groovy)|(\.js)$/,"File name must be like x.groovy or x.js");if(f){newScript(i.val(),h)}}$("p#contextScriptsParagraph").empty().append('<table cellpadding="0" cellspacing="0" border="0" class="display" id="infoTableScripts"/>');$("table#infoTableScripts").append("<thead><tr><th>Type</th><th>Name</th><th>Last modified</th></tr></thead><tbody/><tfoot><tr><th>Type</th><th>Name</th><th>Last modified</th></tr></tfoot>");var d=true;var c="odd.gradeU";var b=$("table#infoTableScripts>tbody");$.each($(e.RESPONSE.FILES),function(g,f){if(!d){c="even.gradeU";d=true}else{c="odd.gradeU";d=false}var h="<tr class='"+c+"' style='text-align:center'><td>"+f.TYPE+"</td><td><a href='#' id='btn-edit"+f.NAME.replace(".","_")+"'>"+f.NAME+"</a></td><td>"+f.MODDATE+"</td></tr>";b.append(h);$("a#btn-edit"+f.NAME.replace(".","_")).click(function(i){i.preventDefault();editScript(f.NAME,e.RESPONSE.CONTEXT)})});$("table#infoTableScripts").dataTable({bLengthChange:false,bPaginate:true,sPaginationType:"full",bSort:true,aaSorting:[[1,"desc"]],bAutoWidth:false,bDestroy:true,bFilter:true,bJQueryUI:false,sDom:'<"H"friT>t<"F"iT>',oTableTools:{aButtons:[{sExtends:"text",sButtonText:"New",sToolTip:"Create new script",fnClick:function(g,h,j){if(isDisabled()){readOnly()}else{var f=$("div#alert");f.dialog({autoOpen:false,closeOnEscape:true,position:{my:"top center",at:"top center",of:$("div#tabs")}});f.dialog({title:"File name",modal:true,draggable:false,resizable:false,height:$(window).height()*0.6,width:"35%",show:{effect:"fade",duration:500},hide:{effect:"scale",duration:1000}});f.html('<div id="dialog-form" title=""><p class="validateTips"></p><form><fieldset><label for="fileNameL">File name</label><input type="text" name="fileName" id="fileNameId" class="text ui-widget-content ui-corner-all"></fieldset></form></div>');$("div#dialog-form label").css("display","block");$("div#dialog-form input").css({display:"block","margin-bottom":"12px",width:"95%",padding:".4em"});$("div#dialog-form .validateTips").css({border:"1px solid transparent",padding:"0.3em"});var i=$("#fileNameId");f.dialog({buttons:[{text:"next",click:function(){a(i,e.RESPONSE.CONTEXT)}}]});$(f).find("input#fileNameId").keypress(function(k){if(k.which==jQuery.ui.keyCode.ENTER){k.preventDefault();a(i,e.RESPONSE.CONTEXT)}});f.dialog({close:function(k,l){unblockUIBlack()}});f.dialog({open:function(k,l){unblockUIBlack()}});f.dialog("open")}}}]},aoColumnDefs:[{sWidth:"10%",aTargets:[0]}]})}function newScript(f,b){function a(g){blockUIBlack();var h=toB64(g);$.post(urlScriptUpload,{fileName:f,context:b,contentB64:h}).always(function(j){var i=jQuery.parseJSON(j);if(i.RESPONSE.STATUS<1){notify("","Problems saving script","warning");unblockUIBlack()}else{notify("","Saved script "+f,"success");$("div#alert").dialog("close");blockUIBlack();var k=urlScriptsList+"&context="+b+"&callback=?";$.getJSON(k).always(function(l){createScriptsListTable(l)})}})}function d(g){if(g.which!=1&&g.which!=jQuery.ui.keyCode.ESCAPE){unblockUIBlack()}}var e=(f.substr(f.lastIndexOf(".")+1)).toLowerCase();var c=e=="js"?"javascript":e;editModalDialog("EDIT: "+f,"",c,a,d)}function editScript(e,b){function a(f){blockUIBlack();var g=toB64(f);$.post(urlScriptUpload,{fileName:e,context:b,contentB64:g}).always(function(i){var h=jQuery.parseJSON(i);if(h.RESPONSE.STATUS<1){notify("","Problems saving script","warning");unblockUIBlack()}else{notify("","Saved script "+e,"success");$("div#alert").dialog("close")}})}function c(f){if(f.which!=1&&f.which!=jQuery.ui.keyCode.ESCAPE){unblockUIBlack()}}blockUIBlack();var d=urlGetScriptContent+"&fileName="+e+"&context="+b+"&callback=?";$.get(d,function(f){var h=(e.substr(e.lastIndexOf(".")+1)).toLowerCase();var g=h=="js"?"javascript":h;editModalDialog("EDIT: "+e,fromB64(f),g,a,c)})}function createContextLogsTable(e,a){$("p#fileLogsParagraph").empty().append('<table cellpadding="0" cellspacing="0" border="0" class="display" id="infoTableLogs"/>');$("table#infoTableLogs").append("<thead><tr><th>Name</th><th>Size KB</th></tr></thead><tbody/><tfoot><tr><th>Name</th><th>Size KB</th></tr></tfoot>");var d=true;var c="odd.gradeU";var b=$("table#infoTableLogs>tbody");$.each($(e.RESPONSE.FILES),function(h,g){var f=urlContextLogContent+"&context="+a.NAME+"&fileName="+g.NAME;if(!d){c="even.gradeU";d=true}else{c="odd.gradeU";d=false}b.append("<tr class='"+c+"' style='text-align:center'><td><a href='"+f+"' id='"+a.NAME+"GetFile'>"+g.NAME+"</a></td><td>"+g.SIZE+"</td></tr>")});$("table#infoTableLogs").dataTable({bLengthChange:false,bPaginate:true,sPaginationType:"full",bSort:true,aaSorting:[[0,"desc"]],bAutoWidth:false,bDestroy:true,bFilter:true,bJQueryUI:false,sDom:'<"H"frip>t<"F"ip>',aoColumnDefs:[{sWidth:"50%",aTargets:[0]}]})}function createRouteLogsTable(f,b,a){$("p#fileLogsParagraph").empty().append('<table cellpadding="0" cellspacing="0" border="0" class="display" id="infoTableLogs"/>');$("table#infoTableLogs").append("<thead><th>Name</th><th>Size KB</th></tr></thead><tbody/><tfoot><tr><th>Name</th><th>Size KB</th></tr></tfoot>");var e=true;var d="odd.gradeU";var c=$("table#infoTableLogs>tbody");$.each($(f.RESPONSE.FILES),function(h,g){var i=urlRouteLogContent+"&context="+b.NAME+"&route="+a.NAME+"&fileName="+g.NAME;if(!e){d="even.gradeU";e=true}else{d="odd.gradeU";e=false}c.append("<tr class='"+d+"' style='text-align:center'><td><a href='"+i+"' id='"+b.NAME+a.NAME+"GetFile'>"+g.NAME+"</a></td><td>"+g.SIZE+"</td></tr>")});$("table#infoTableLogs").dataTable({bLengthChange:false,bPaginate:true,sPaginationType:"full",bSort:true,aaSorting:[[0,"desc"]],bAutoWidth:false,bDestroy:true,bFilter:true,bJQueryUI:false,sDom:'<"H"frip>t<"F"ip>',aoColumnDefs:[{sWidth:"50%",aTargets:[0]}]})}function editBeans(c){function a(e){blockUIBlack();var f=toB64(e);$.post(urlSaveContextBeans,{context:c,spring:f}).always(function(h){var g=jQuery.parseJSON(h);if(g.RESPONSE.STATUS<1){notify("","Error saving beans for "+g.RESPONSE.CONTEXT+"\n"+fromB64(g.RESPONSE.ERRORMESSAGE),"error");unblockUIBlack()}else{notify("","Saved beans for "+g.RESPONSE.CONTEXT,"success");$("div#alert").dialog("close");createTree(null)}})}function d(e){if(e.which!=1&&e.which!=jQuery.ui.keyCode.ESCAPE){unblockUIBlack()}}blockUIBlack();var b=urlGetContextBeans+"&context="+c;$.get(b,function(e){var f=jQuery.parseJSON(e);if(f.RESPONSE.STATUS<1){notify("","Error reading beans for "+f.RESPONSE.CONTEXT,"error");unblockUIBlack()}else{editModalDialog("EDIT: "+f.RESPONSE.CONTEXT+" beans",fromB64(f.RESPONSE.RESULT),"xml",a,d)}})}function editContextProperties(b){function a(e){blockUIBlack();var f=toB64(e);$.post(urlSaveContextProperties,{context:b,spring:f}).always(function(h){var g=jQuery.parseJSON(h);if(g.RESPONSE.STATUS<1){notify("","Error saving properties for "+g.RESPONSE.CONTEXT+"\n"+fromB64(g.RESPONSE.ERRORMESSAGE),"error");unblockUIBlack()}else{notify("","Saved properties for "+g.RESPONSE.CONTEXT,"success");$("div#alert").dialog("close")}})}function c(e){if(e.which!=1&&e.which!=jQuery.ui.keyCode.ESCAPE){unblockUIBlack()}}blockUIBlack();var d=urlGetContextProperties+"&context="+b;$.get(d,function(e){var f=jQuery.parseJSON(e);if(f.RESPONSE.STATUS<1){notify("","Error reading properties for "+f.RESPONSE.CONTEXT,"error");unblockUIBlack()}else{editModalDialog("EDIT: "+f.RESPONSE.CONTEXT+" properties",fromB64(f.RESPONSE.RESULT),"xml",a,c)}})}function startStopRoute(b,a,c){divQuestion.html("<h4>"+c.toUpperCase()+"<br/> "+b+"."+a+'<br/> can take a long time.<br/><br/>Are you sure?</h4><input type="button" id="yes" value="Yes" /><input type="button" id="no" value="No" />');$.blockUI({message:divQuestion,css:{padding:"25px",backgroundColor:"#eee"}});$("input#yes").click(function(){blockUIBlack();var d=urlRouteStart;if(c.toLowerCase()=="stop"){d=urlRouteStop}d+="&context="+b+"&route="+a+"&callback=?";$.getJSON(d).always(function(f){var e=a.replace(/\./g,"_");$("a#"+b+e+"INFO").trigger("click")})});$("input#no").click(function(){unblockUIBlack();return false})}function resetRoute(b,a){divQuestion.html("<h4>Reset statistics for<br/>"+b+"."+a+'.<br/><br/>Are you sure?</h4><input type="button" id="yes" value="Yes" /><input type="button" id="no" value="No" />');$.blockUI({message:divQuestion,css:{padding:"25px",backgroundColor:"#eee",width:"375px"}});$("input#yes").click(function(){blockUIBlack();var c=urlRouteReset+"&context="+b+"&route="+a+"&callback=?";$.getJSON(c).always(function(e){var d=a.replace(/\./g,"_");$("a#"+b+d+"INFO").trigger("click");$("h3#accordionInfoContext").trigger("click")})});$("input#no").click(function(){unblockUIBlack();return false})}function editRouteXML(c,b){function a(f){blockUIBlack();var g=toB64(f);$.post(urlRouteAdd,{context:c,route:b,spring:g}).always(function(i){var h=jQuery.parseJSON(i);if(h.RESPONSE.STATUS<1){notify("","Error saving route "+h.RESPONSE.CONTEXT+"."+h.RESPONSE.ROUTE+"\n"+fromB64(h.RESPONSE.ERRORMESSAGE),"error");unblockUIBlack()}else{notify("","Saved route "+h.RESPONSE.ROUTE+" to "+h.RESPONSE.CONTEXT,"success");$("div#alert").dialog("close")}})}function d(g){if(g.which!=1&&g.which!=jQuery.ui.keyCode.ESCAPE){unblockUIBlack();var f=b.replace(/\./g,"_");$("a#"+c+f+"Info").trigger("click")}}blockUIBlack();var e=urlRouteXml+"&context="+c+"&route="+b;$.get(e,function(f){editModalDialog("EDIT: "+c+"."+b,f,"xml",a,d)})}function addRouteXML(c){function a(e){blockUIBlack();var f=toB64(e);$.post(urlRouteAdd,{context:c,route:"",spring:f}).always(function(h){var g=jQuery.parseJSON(h);if(g.RESPONSE.STATUS<1){notify("","Error adding route to "+g.RESPONSE.CONTEXT+"\n"+fromB64(g.RESPONSE.ERRORMESSAGE),"error");unblockUIBlack()}else{notify("","Added route "+g.RESPONSE.CONTEXT+"."+g.RESPONSE.ROUTE,"success");$("div#alert").dialog("close")}})}function b(){$("span#"+c+"Folder").trigger("click")}function d(e){if(e.which!=1&&e.which!=jQuery.ui.keyCode.ESCAPE){createTree(b)}}blockUIBlack();editModalDialog("ADD ROUTE TO CONTEXT: "+c,"","xml",a,d)}function createRouteTable(b,c){$("p#infoParagraph").empty().append('<table cellpadding="0" cellspacing="0" border="0" class="display" id="infoTable"/>');$("table#infoTable").append("<thead><tr><th>Attribute</th><th>Value</th></tr></thead>").append("<tbody/><tfoot><tr><th>Attribute</th><th>Value</th></tr></tfoot>");var d=$("table#infoTable>tbody");var a='<tr class="odd.gradeU"><td>Type</td><td>ROUTE</td></tr>';a+='<tr class="even.gradeU"><td>Name</td><td>'+b.NAME+" (context "+c.NAME+")</td></tr>";a+='<tr class="odd.gradeU"><td>Status</td><td>'+b.STATUS_STRING+"</td></tr>";a+='<tr class="even.gradeU"><td>Endpoint Uri</td><td>'+b.ENDPOINTURI+"</td></tr>";a+='<tr class="odd.gradeU"><td>Inflight Exchanges</td><td>'+b.INFLIGHTS+"</td></tr>";a+='<tr class="even.gradeU"><td>First Exchange Completed</td><td>'+b.FIRSTEXCHANGECOMPLETEDTIMESTAMP+"</td></tr>";a+='<tr class="odd.gradeU"><td>Last Exchange Completed</td><td>'+b.LASTEXCHANGECOMPLETEDTIMESTAMP+"</td></tr>";a+='<tr class="even.gradeU"><td>Exchanges Total</td><td>'+b.EXCHANGESTOTAL+"</td></tr>";a+='<tr class="odd.gradeU"><td>Exchanges Completed</td><td>'+b.EXCHANGESCOMPLETED+"</td></tr>";a+='<tr class="even.gradeU"><td>Exchanges Failed</td><td>'+b.EXCHANGESFAILED+"</td></tr>";a+='<tr class="odd.gradeU"><td>Failures Handled</td><td>'+b.FAILURESHANDLED+"</td></tr>";a+='<tr class="even.gradeU"><td>Max Processing Time</td><td>'+b.MAXPROCESSINGTIME+"</td></tr>";a+='<tr class="odd.gradeU"><td>Mean Processing Time</td><td>'+b.MEANPROCESSINGTIME+"</td></tr>";a+='<tr class="even.gradeU"><td>Min Processing Time</td><td>'+b.MINPROCESSINGTIME+"</td></tr>";a+='<tr class="odd.gradeU"><td>Last Processing Time</td><td>'+b.LASTPROCESSINGTIME+"</td></tr>";a+='<tr class="even.gradeU"><td>Total Processing Time</td><td>'+b.TOTALPROCESSINGTIME+"</td></tr>";d.append(a);$("table#infoTable").dataTable({bPaginate:false,sPaginationType:"full",bSort:false,bAutoWidth:false,bDestroy:true,bFilter:false,bJQueryUI:false,sDom:'<"H"fr>t<"F">',aoColumnDefs:[{sWidth:"25%",aTargets:[0]}]})}function startStopContext(a,b){var c=b.toLowerCase()=="resetcl"?"RESET class loader for<br/>"+a:b.toUpperCase()+"<br/>"+a+"<br/>can take a long time";divQuestion.html("<h4>"+c+'.<br/><br/>Are you sure?</h4><input type="button" id="yes" value="Yes" /><input type="button" id="no" value="No" />');$.blockUI({message:divQuestion,css:{padding:"25px",backgroundColor:"#eee"}});$("input#yes").click(function(){blockUIBlack();var d=urlContextStart;if(b.toLowerCase()=="suspend"){d=urlContextStop}else{if(b.toLowerCase()=="resetcl"){d=urlContextCLReset}}d+="&context="+a+"&callback=?";$.getJSON(d).always(function(e){if(b.toLowerCase()!="resetcl"){if(e.RESPONSE.STATUS=="1"){location.reload()}else{unblockUIBlack();notify("","Command error for context "+a,"error")}}else{unblockUIBlack();if(e.RESPONSE.STATUS=="1"){notify("","Resetted class loader for context "+a,"success")}else{notify("","Error resetting class loader for context "+a,"error")}}})});$("input#no").click(function(){unblockUIBlack();return false})}function createContextTable(b){$("p#infoParagraph").empty().append('<table cellpadding="0" cellspacing="0" border="0" class="display" id="infoTable"/>');$("table#infoTable").append("<thead><tr><th>Attribute</th><th>Value</th></tr></thead><tbody/><tfoot><tr><th>Attribute</th><th>Value</th></tr></tfoot>");var c=$("table#infoTable>tbody");var a='<tr class="odd.gradeU"><td>Type</td><td>CONTEXT</td></tr>';a+='<tr class="even.gradeU"><td>Name</td><td>'+b.NAME+"</td></tr>";a+='<tr class="odd.gradeU"><td>Status</td><td>'+b.STATUS_STRING+"</td></tr>";a+='<tr class="even.gradeU"><td>Shutdown Timeout</td><td>'+b.SHUTDOWNTIMEOUT+"</td></tr>";a+='<tr class="odd.gradeU"><td>Shutdown now on timeout</td><td>'+b.SHUTDOWNNOWONTIMEOUT+"</td></tr>";a+='<tr class="even.gradeU"><td>Shutdown routes in reverse order</td><td>'+b.SHUTDOWNROUTESINREVERSEORDER+"</td></tr>";a+='<tr class="odd.gradeAC"><td>First Exchange Completed</td><td>'+b.FIRSTEXCHANGECOMPLETEDTIMESTAMP+"</td></tr>";a+='<tr class="even.gradeU"><td>Last Exchange Completed</td><td>'+b.LASTEXCHANGECOMPLETEDTIMESTAMP+"</td></tr>";a+='<tr class="odd.gradeU"><td>Exchanges Total</td><td>'+b.EXCHANGESTOTAL+"</td></tr>";a+='<tr class="even.gradeU"><td>Exchanges Completed</td><td>'+b.EXCHANGESCOMPLETED+"</td></tr>";a+='<tr class="odd.gradeU"><td>Exchanges Failed</td><td>'+b.EXCHANGESFAILED+"</td></tr>";a+='<tr class="even.gradeU"><td>Failures Handled</td><td>'+b.FAILURESHANDLED+"</td></tr>";a+='<tr class="odd.gradeU"><td>Inflight Exchanges</td><td>'+b.INFLIGHTS+"</td></tr>";a+='<tr class="even.gradeU"><td>Max Processing Time</td><td>'+b.MAXPROCESSINGTIME+"</td></tr>";a+='<tr class="odd.gradeU"><td>Mean Processing Time</td><td>'+b.MEANPROCESSINGTIME+"</td></tr>";a+='<tr class="even.gradeU"><td>Min Processing Time</td><td>'+b.MINPROCESSINGTIME+"</td></tr>";a+='<tr class="odd.gradeU"><td>Last Processing Time</td><td>'+b.LASTPROCESSINGTIME+"</td></tr>";a+='<tr class="even.gradeU"><td>Total Processing Time</td><td>'+b.TOTALPROCESSINGTIME+"</td></tr>";a+='<tr class="odd.gradeU"><td>Uptime</td><td>'+b.UPTIME+"</td></tr>";a+='<tr class="even.gradeU"><td>Delete log files older than</td><td>'+b.DELETEOLDLOGFILESDAYS+" days</td></tr>";a+='<tr class="odd.gradeU"><td>Delete logs on database older than</td><td>'+b.DELETEOLDLOGDBDAYS+" days</td></tr>";a+='<tr class="even.gradeU"><td>Class loader path</td><td>'+b.CLASSLOADERPATH+"</td></tr>";c.append(a);$("table#infoTable").dataTable({bPaginate:false,sPaginationType:"full",bSort:false,bAutoWidth:false,bDestroy:true,bFilter:false,bJQueryUI:false,sDom:'<"H"fr>t<"F">',aoColumnDefs:[{sWidth:"25%",aTargets:[0]}]})}function createDBLogsTable(a,d,c){$("p#dbLogsParagraph").empty().append('<table cellpadding="0" cellspacing="0" border="0" class="display" id="infoTableDB"/>');$("table#infoTableDB").append("<thead><tr><th>Level</th><th>Message</th><th>Date</th><th>Acknowledge</th></tr></thead>").append("<tbody/><tfoot><tr><th>Level</th><th>Message</th><th>Date</th><th>Acknowledge</th></tr></tfoot>");var g=true;var f="odd.gradeU";var e=$("table#infoTableDB>tbody");$.each($(a.RESPONSE.ROWS),function(h,i){if(!g){f="even.gradeU";g=true}else{f="odd.gradeU";g=false}e.append("<tr class='"+f+"'><td style='text-align:center'>"+fromB64(i.LOG_LEVEL)+"</td><td>"+fromB64(i.LOG_MESSAGE.substring(0,350))+"</td><td style='text-align:center'>"+fromB64(i.DATE_TIME)+"</td><td class='acknowledge' style='text-align:center' id='"+fromB64(i.TABLE_NAME)+"@"+fromB64(i.IDEN)+"'>"+fromB64(i.ACKNOWLEDGE)+"</td></tr>")});var b=$("table#infoTableDB").dataTable({bLengthChange:false,bPaginate:true,sPaginationType:"full",bSort:false,bAutoWidth:false,bDestroy:true,bFilter:true,bJQueryUI:false,sDom:'<"H"Tfrip>t<"F"ip>',oTableTools:{sSwfPath:"monitor/media/swf/copy_csv_xls_pdf.swf",aButtons:[{sExtends:"pdf",sPdfOrientation:"landscape",sPdfMessage:dateHR(),sToolTip:"Export table as PDF",sTitle:"ELCOMiddleware_"+getURLIP()+"_"+d.NAME+"_"+c.NAME},{sExtends:"text",sButtonText:"ACK",sToolTip:"Acknowledge all rows",fnClick:function(h,i,j){if(isDisabled()){readOnly()}else{divQuestion.html('<h4>Acknowledge all WARN/ERROR events. Are you sure?</h4><input type="button" id="yes" value="Yes" /><input type="button" id="no" value="No" />');$.blockUI({message:divQuestion,css:{padding:"25px",backgroundColor:"#eee",width:"375px"}});$("input#yes").click(function(){blockUIBlack();var k=urlAcknowledgeAll+"&context="+d.NAME+"&route="+c.NAME+"&callback=?";$.getJSON(k).always(function(m){var l=urlRouteDBLogs+"&context="+d.NAME+"&route="+c.NAME+"&callback=?";$.getJSON(l).always(function(n){createDBLogsTable(n,d,c);unblockUIBlack()})})});$("input#no").click(function(){unblockUIBlack();return false})}}}]},aoColumnDefs:[{sWidth:"10%",aTargets:[0]},{sWidth:"50%",aTargets:[1]}]});b.$(".acknowledge").editable(urlAcknowledge,{data:"{'Y':'Y', 'N':'N'}",type:"select",indicator:"Saving...",tooltip:"Click to edit...",submit:"Save",height:"100%",width:"100%",callback:function(j,i){var h=b.fnGetPosition(this);b.fnUpdate(j,h[0],h[1])}})}function createContextDBLogsTable(a,c){$("p#dbLogsParagraph").empty().append('<table cellpadding="0" cellspacing="0" border="0" class="display" id="infoTableDB"/>');$("table#infoTableDB").append("<thead><tr><th>Level</th><th>Message</th><th>Date</th><th>Acknowledge</th></tr></thead>").append("<tbody/><tfoot><tr><th>Level</th><th>Message</th><th>Date</th><th>Acknowledge</th></tr></tfoot>");var f=true;var e="odd.gradeU";var d=$("table#infoTable>tbody");$.each($(a.RESPONSE.ROWS),function(g,h){if(!f){e="even.gradeU";f=true}else{e="odd.gradeU";f=false}d.append("<tr class='"+e+"'><td style='text-align:center'>"+fromB64(h.LOG_LEVEL)+"</td><td>"+fromB64(h.LOG_MESSAGE.substring(0,350))+"</td><td style='text-align:center'>"+fromB64(h.DATE_TIME)+"</td><td class='acknowledge' style='text-align:center' id='"+fromB64(h.TABLE_NAME)+"@"+fromB64(h.IDEN)+"'>"+fromB64(h.ACKNOWLEDGE)+"</td></tr>")});var b=$("table#infoTableDB").dataTable({bLengthChange:false,bPaginate:true,sPaginationType:"full",bSort:false,bAutoWidth:false,bDestroy:true,bFilter:true,bJQueryUI:false,sDom:'<"H"Tfrip>t<"F"ip>',oTableTools:{sSwfPath:"monitor/media/swf/copy_csv_xls_pdf.swf",aButtons:[{sExtends:"pdf",sPdfOrientation:"landscape",sPdfMessage:dateHR(),sToolTip:"Export table as PDF",sTitle:"ELCOMiddleware_"+getURLIP()+"_"+c.NAME},{sExtends:"text",sButtonText:"ACK",sToolTip:"Acknowledge all rows",fnClick:function(g,h,i){if(isDisabled()){readOnly()}else{divQuestion.html('<h4>Acknowledge all WARN/ERROR events. Are you sure?</h4><input type="button" id="yes" value="Yes" /><input type="button" id="no" value="No" />');$.blockUI({message:divQuestion,css:{padding:"25px",backgroundColor:"#eee",width:"375px"}});$("input#yes").click(function(){blockUIBlack();var j=urlAcknowledgeAll+"&context="+c.NAME+"&callback=?";$.getJSON(j).always(function(l){var k=urlContextDBLogs+"&context="+c.NAME+"&callback=?";$.getJSON(k).always(function(m){createContextDBLogsTable(m,c)})})});$("input#no").click(function(){unblockUIBlack();return false})}}}]},aoColumnDefs:[{sWidth:"10%",aTargets:[0]}]});b.$(".acknowledge").editable(urlAcknowledge,{data:"{'Y':'Y', 'N':'N'}",type:"select",indicator:"Saving...",tooltip:"Click to edit...",submit:"Save",height:"100%",width:"100%",callback:function(i,h){var g=b.fnGetPosition(this);b.fnUpdate(i,g[0],g[1])}})}function activemqTopicsList(){blockUIBlack();$("p#infoParagraphAMQT").empty();$("div#div_browserAMQT").html("<ul id='browserAMQT' class='filetree'></ul>");var a=$("div#div_browserAMQT>ul#browserAMQT");$.getJSON(urlActiveMQTopicsList).always(function(b){$.each($(b.BROKER),function(d,c){a.append("<li class='menu' id='"+c.NAME+"'></li>");var e=$(a).find("li#"+c.NAME);e.append("<span id='"+c.NAME+"Folder' class='folder menuContext' isbroker='true' broker='"+c.NAME+"'>"+c.NAME+"</span>");$.each($(c.TOPIC),function(h,f){var g=f.NAME.replace(/\./g,"_");e.append("<ul><li><span id='"+c.NAME+g+"SPAN' class='menu file' broker='"+c.NAME+"' topic='"+f.NAME+"'><a style='text-decoration: none;' href='#' id='"+c.NAME+g+"Info'>"+f.NAME+"</a></span></li></ul>");$("a#"+c.NAME+g+"Info").click(function(){blockUIBlack();var i=urlActiveMQTopic+"&topic="+f.NAME;$.getJSON(i).always(function(j){createTopicsTable(j.BROKER.NAME,j.BROKER.TOPIC)})})})});a.treeview({collapsed:true});contextMenuTopic();unblockUIBlack()})}function createTopicsTable(b,a){$("div#div_infoParagraphAMQT").fadeOut(fadeOutTime,function(){$("p#infoParagraphAMQT").empty().append('<table cellpadding="0" cellspacing="0" border="0" class="display" id="infoTableAMQT"/>');$("table#infoTableAMQT").append("<thead><tr><th>Property</th><th>Value</th></tr></thead><tbody/><tfoot><tr><th>Property</th><th>Value</th></tr></tfoot>");var e=true;var d="odd.gradeU";var c=$("table#infoTableAMQT>tbody");$.each($(a.INFO),function(f,g){if(g.NAME=="SUBSCRIBER"){d="even.gradeA"}else{if(!e){d="even.gradeU";e=true}else{d="odd.gradeU";e=false}}c.append("<tr class='"+d+"'><td>"+g.NAME+"</td><td align='center'>"+g.VALUE+"</td></tr>")});$("table#infoTableAMQT").dataTable({bPaginate:true,bLengthChange:false,iDisplayLength:15,sPaginationType:"full",bSort:false,bAutoWidth:false,bDestroy:true,bFilter:false,bJQueryUI:false,oTableTools:{sSwfPath:"monitor/media/swf/copy_csv_xls_pdf.swf",aButtons:[{sExtends:"pdf",sPdfOrientation:"landscape",sPdfMessage:dateHR(),sToolTip:"Export table as PDF",sTitle:"ELCOMiddleware_"+getURLIP()+"_"+b+"_"+a.NAME}]},sDom:'l<"toolbar"><"H"Tfrip>t<"F"ip>',aoColumnDefs:[{sWidth:"25%",aTargets:[0]}]});$("div.toolbar").html("<b>"+b+" - "+a.NAME+" - max 300 lines</b>");$(this).slideDown("fast",function(){unblockUIBlack()})})}function contextMenuTopic(){function b(e){var d=checkLength(e,"Topic name",3,20);if(d){divQuestion.html("<h4>New topic "+e.val()+' will be added.<br/>Are you sure?</h4><input type="button" id="yes" value="Yes"/><input type="button" id="no" value="No"/>');$.blockUI({message:divQuestion,css:{padding:"25px",backgroundColor:"#eee",width:"375px"}});$("input#yes").click(function(){var f=urlActiveMQAddTopic+"&topic="+e.val();$.getJSON(f).always(function(g){activemqTopicsList();$("div#alert").dialog("close")})});$("input#no").click(function(){unblockUIBlack();return false})}}function a(g,e,d,f){var h=checkLength(e,"Client ID",3,20);h=h&&checkRegexp(d,/^([a-zA-Z])*$/,"Selector field only allow: a-z and A-Z");h=h&&checkLength(f,"Subscription name",3,20);if(h){divQuestion.html("<h4>New subscriber "+f.val()+' will be added.<br/>Are you sure?</h4><input type="button" id="yes" value="Yes"/><input type="button" id="no" value="No"/>');$.blockUI({message:divQuestion,css:{padding:"25px",backgroundColor:"#eee",width:"375px"}});$("input#yes").click(function(){var i=urlActiveMQAddSubscriber+"&topic="+g+"&clientId="+e.val()+"&selector="+d.val()+"&durableSubscriptionId="+f.val();$.getJSON(i).always(function(j){activemqTopicsList();$("div#alert").dialog("close")})});$("input#no").click(function(){unblockUIBlack();return false})}}function c(f,d,e){var g=checkLength(d,"Client ID",3,20);g=g&&checkLength(e,"Subscription name",3,20);if(g){divQuestion.html("<h4>Subscriber "+e.val()+' will be removed.<br/>Are you sure?</h4><input type="button" id="yes" value="Yes"/><input type="button" id="no" value="No"/>');$.blockUI({message:divQuestion,css:{padding:"25px",backgroundColor:"#eee",width:"375px"}});$("input#yes").click(function(){var h=urlActiveMQRemoveSubscriber+"&topic="+f+"&clientId="+d.val()+"&durableSubscriptionId="+e.val();$.getJSON(h).always(function(i){activemqTopicsList();$("div#alert").dialog("close")})});$("input#no").click(function(){unblockUIBlack();return false})}}$("div#div_browserAMQT").contextmenu({delegate:".menu",menu:[{title:"empty"}],beforeOpen:function(g,h){var f=h.target.closest("span[broker]");var e=f.attr("isbroker");var i=(typeof e=="undefined")?false:true;var d=isDisabled();if(!i){$(this).contextmenu("replaceMenu",[{title:"Delete",cmd:"deleteTopic",uiIcon:"ui-icon-trash",disabled:d},{title:"----"},{title:"Add subscriber",cmd:"addSubscriber",uiIcon:"ui-icon-plus",disabled:d},{title:"Remove subscriber",cmd:"removeSubscriber",uiIcon:"ui-icon-minus",disabled:d}])}else{$(this).contextmenu("replaceMenu",[{title:"Add topic",cmd:"addTopic",uiIcon:"ui-icon-plus",disabled:d}])}},select:function(h,i){if(i.target.length>0){var g=i.target.closest("span[broker]");if(i.cmd=="deleteTopic"){var f=g.attr("topic");divQuestion.html("<h4>Delete topic "+f+'.<br/>Are you sure?</h4><input type="button" id="yes" value="Yes" /><input type="button" id="no" value="No" />');$.blockUI({message:divQuestion,css:{padding:"25px",backgroundColor:"#eee",width:"375px"}});$("input#yes").click(function(){var j=urlActiveMQTopicRemove+"&topic="+f;$.getJSON(j).always(function(k){unblockUIBlack();activemqTopicsList()})});$("input#no").click(function(){unblockUIBlack();return false})}else{if(i.cmd=="addSubscriber"){blockUIBlack();var f=g.attr("topic");var e=$("div#alert");e.dialog({autoOpen:false,closeOnEscape:true,position:{my:"top center",at:"top center",of:$("div#tabs")}});e.dialog({title:"Add subscriber to "+f,modal:true,draggable:false,resizable:false,height:$(window).height()*0.6,width:"35%",show:{effect:"scale",duration:500},hide:{effect:"scale",duration:1000}});e.html('<div id="dialog-form" title=""><p class="validateTips"></p><form><fieldset><label for="clientIdL">Client ID</label><input type="text" name="clientId" id="clientId" class="text ui-widget-content ui-corner-all"><label for="selectorL">Selector</label><input type="text" name="selector" id="selector" value="" class="text ui-widget-content ui-corner-all"><label for="durableSubscriptionIdL">Subscription name</label><input type="text" name="durableSubscriptionId" id="durableSubscriptionId" value="" class="text ui-widget-content ui-corner-all"></fieldset></form></div>');$("div#dialog-form label").css("display","block");$("div#dialog-form input").css({display:"block","margin-bottom":"12px",width:"95%",padding:".4em"});$("div#dialog-form .validateTips").css({border:"1px solid transparent",padding:"0.3em"});e.dialog({buttons:[{text:"Add",click:function(){a(f,$("#clientId"),$("#selector"),$("#durableSubscriptionId"))}}]});$(e).find("input#clientId, input#selector, input#durableSubscriptionId").keypress(function(j){if(j.which==jQuery.ui.keyCode.ENTER){j.preventDefault();a(f,$("#clientId"),$("#selector"),$("#durableSubscriptionId"))}});e.dialog({close:function(j,k){unblockUIBlack()}});e.dialog({open:function(j,k){unblockUIBlack()}});e.dialog("open")}else{if(i.cmd=="removeSubscriber"){blockUIBlack();var f=g.attr("topic");var e=$("div#alert");e.dialog({autoOpen:false,closeOnEscape:true,position:{my:"top center",at:"top center",of:$("div#tabs")}});e.dialog({title:"Remove subscriber from "+f,modal:true,draggable:false,resizable:false,height:$(window).height()*0.6,width:"35%",show:{effect:"scale",duration:500},hide:{effect:"scale",duration:1000}});e.html('<div id="dialog-form" title=""><p class="validateTips"></p><form><fieldset><label for="clientIdL">Client ID</label><input type="text" name="clientId" id="clientId" class="text ui-widget-content ui-corner-all"><label for="durableSubscriptionIdL">Subscription name</label><input type="text" name="durableSubscriptionId" id="durableSubscriptionId" value="" class="text ui-widget-content ui-corner-all"></fieldset></form></div>');$("div#dialog-form label").css("display","block");$("div#dialog-form input").css({display:"block","margin-bottom":"12px",width:"95%",padding:".4em"});$("div#dialog-form .validateTips").css({border:"1px solid transparent",padding:"0.3em"});e.dialog({buttons:[{text:"Remove",click:function(){c(f,$("#clientId"),$("#durableSubscriptionId"))}}]});$(e).find("input#clientId, input#durableSubscriptionId").keypress(function(j){if(j.which==jQuery.ui.keyCode.ENTER){j.preventDefault();c(f,$("#clientId"),$("#durableSubscriptionId"))}});e.dialog({close:function(j,k){unblockUIBlack()}});e.dialog({open:function(j,k){unblockUIBlack()}});e.dialog("open")}else{if(i.cmd=="addTopic"){blockUIBlack();var d=g.attr("broker");var e=$("div#alert");e.dialog({autoOpen:false,closeOnEscape:true,position:{my:"top center",at:"top center",of:$("div#tabs")}});e.dialog({title:"Add topic to "+d+" broker",modal:true,draggable:false,resizable:false,height:$(window).height()*0.6,width:"35%",show:{effect:"scale",duration:500},hide:{effect:"scale",duration:1000}});e.html('<div id="dialog-form" title=""><p class="validateTips"></p><form><fieldset><label for="topicName">Topic name</label><input type="text" name="topicName" id="topicName" class="text ui-widget-content ui-corner-all"></fieldset></form></div>');$("div#dialog-form label").css("display","block");$("div#dialog-form input").css({display:"block","margin-bottom":"12px",width:"95%",padding:".4em"});$("div#dialog-form .validateTips").css({border:"1px solid transparent",padding:"0.3em"});e.dialog({buttons:[{text:"Add",click:function(){b($("#topicName"))}}]});$(e).find("input#topicName").keypress(function(j){if(j.which==jQuery.ui.keyCode.ENTER){j.preventDefault();b($("#topicName"))}});e.dialog({close:function(j,k){unblockUIBlack()}});e.dialog({open:function(j,k){unblockUIBlack()}});e.dialog("open")}}}}}}})}function activemqQueuesList(){blockUIBlack();$("p#infoParagraphAMQ").empty();$("div#div_browserAMQ").html("<ul id='browserAMQ' class='filetree'></ul>");var a=$("div#div_browserAMQ>ul#browserAMQ");$.getJSON(urlActiveMQQueuesList).always(function(b){$.each($(b.BROKER),function(d,c){a.append("<li id='"+c.NAME+"'></li>");var e=$(a).find("li#"+c.NAME);e.append("<span id='"+c.NAME+"Folder' class='folder menuContext' broker='"+c.NAME+"'>"+c.NAME+"</span>");$.each($(c.QUEUE),function(g,f){var h=f.NAME.replace(/\./g,"_");e.append("<ul><li><span id='"+c.NAME+h+"SPAN' class='menu file' broker='"+c.NAME+"' queue='"+f.NAME+"'><a style='text-decoration: none;' href='#' id='"+c.NAME+h+"Info'>"+f.NAME+"</a></span></li></ul>");$("a#"+c.NAME+h+"Info").click(function(){blockUIBlack();var i=urlActiveMQQueue+"&queue="+f.NAME;$.getJSON(i).always(function(j){createQueueMessagesTable(j.BROKER.NAME,j.BROKER.QUEUE)})})})});a.treeview({collapsed:true});contextMenuQueue();unblockUIBlack()})}function createQueueMessagesTable(b,a){$("div#div_infoParagraphAMQ").fadeOut(fadeOutTime,function(){$("p#infoParagraphAMQ").empty().append('<table cellpadding="0" cellspacing="0" border="0" class="display" id="infoTableAMQ"/>');$("table#infoTableAMQ").append("<thead><tr><th>Timestamp</th><th>Message</th><th>Delete</th></tr></thead><tbody/><tfoot><tr><th>Timestamp</th><th>Message</th><th>Delete</th></tr></tfoot>");var e=true;var d="odd.gradeU";var c=$("table#infoTableAMQ>tbody");$.each($(a.MESSAGE),function(f,g){if(!e){d="even.gradeU";e=true}else{d="odd.gradeU";e=false}var h=userRoles=="admin"?" ":"disabled";c.append("<tr class='"+d+"'><td>"+g.TIMESTAMP+"</td><td id='"+g.ID+"'>"+fromB64(g.TEXT)+"</td><td><button id='btn-delete"+g.ID+"'"+h+">Delete</button></td></tr>");$("td#"+g.ID).on("click",function(){divQuestion.html("<h4>"+g.HEADERS+'</h4><input type="button" id="close" value="CLOSE" />');$.blockUI({message:divQuestion,css:{padding:"25px",backgroundColor:"#eee",left:"25%",width:"50%",top:"30%",height:"40%",centerX:true,centerY:true}});$("input#close").click(function(){unblockUIBlack();return false})});$("button#btn-delete"+g.ID).click(function(i){divQuestion.html('<h4>Delete message.<br/>Are you sure?</h4><input type="button" id="yes" value="Yes" /><input type="button" id="no" value="No" />');$.blockUI({message:divQuestion,css:{padding:"25px",backgroundColor:"#eee",width:"375px"}});$("input#yes").click(function(){i.preventDefault();blockUIBlack();var j=urlActiveMQRemoveMessage+"&queue="+a.NAME+"&messageID="+g.ID;$.getJSON(j).always(function(k){if(k.RESPONSE.STATUS==1){var l=a.NAME.replace(/\./g,"_");$("a#"+b+l+"Info").click()}else{notify("","Error removing message","error");unblockUIBlack()}})});$("input#no").click(function(){unblockUIBlack();return false})})});$("table#infoTableAMQ").dataTable({bPaginate:true,bLengthChange:false,iDisplayLength:10,sPaginationType:"full",bSort:false,bAutoWidth:false,bDestroy:true,bFilter:true,bJQueryUI:false,oTableTools:{sSwfPath:"monitor/media/swf/copy_csv_xls_pdf.swf",aButtons:[{sExtends:"pdf",sPdfOrientation:"landscape",sPdfMessage:dateHR(),sToolTip:"Export table as PDF",sTitle:"ELCOMiddleware_"+getURLIP()+"_"+b+"_"+a.NAME}]},sDom:'l<"toolbar"><"H"Tfrip>t<"F"ip>',aoColumnDefs:[{sWidth:"25%",aTargets:[0]}]});$("div.toolbar").html("<b>"+b+" - "+a.NAME+" - max 300 messages</b>");$(this).slideDown("fast",function(){unblockUIBlack()})})}function contextMenuQueue(){var a=isDisabled();$("div#div_browserAMQ").contextmenu({delegate:".menu",menu:[{title:"Delete",cmd:"deleteQueue",uiIcon:"ui-icon-trash",disabled:a}],beforeOpen:function(e,f){var d=f.target.closest("span[broker]");var b=d.attr("queue");var c=(typeof b=="undefined")?false:true;$(this).contextmenu("showEntry","deleteQueue",c)},select:function(d,e){if(e.target.length>0){var c=e.target.closest("span[broker]");var b=c.attr("queue");if(typeof b=="undefined"){if(e.cmd=="deleteMessages"){divQuestion.html('<h4>Delete all messages.<br/>Are you sure?</h4><input type="button" id="yes" value="Yes" /><input type="button" id="no" value="No" />');$.blockUI({message:divQuestion,css:{padding:"25px",backgroundColor:"#eee",width:"375px"}});$("input#yes").click(function(){$.getJSON(urlActivemqBrokerDeleteMessages).always(function(f){unblockUIBlack();activemqQueuesList()})});$("input#no").click(function(){unblockUIBlack();return false})}}else{if(e.cmd=="deleteQueue"){divQuestion.html("<h4>Remove queue "+b+'.<br/>Are you sure?</h4><input type="button" id="yes" value="Yes" /><input type="button" id="no" value="No" />');$.blockUI({message:divQuestion,css:{padding:"25px",backgroundColor:"#eee",width:"375px"}});$("input#yes").click(function(){var f=urlActiveMQQueueRemove+"&queue="+b;$.getJSON(f).always(function(g){unblockUIBlack();activemqQueuesList()})});$("input#no").click(function(){unblockUIBlack();return false})}}}}})}function utilities(){function e(i,f){var h=6;var g=0;var j="";$.each(i,function(n,m){g++;if(g==1){j+='<div class="tableRow">'}var l=m.NAME;var k=l.replace(/\./g,"_")+"loglevel";j+='<div class="tableCell righTextAlign"><b>'+l+"</b>: </div>";j+='<div class="tableCell"><select id="'+k+'"></select></div>';if(g==h){j+="</div>";g=0}});if(g>0){j+="</div>"}f.append(j);$.each(i,function(p,n){var m=n.NAME;var l=m.replace(/\./g,"_")+"loglevel";var o=$("select#"+l);o.append("<option>TRACE</option>");o.append("<option>DEBUG</option>");o.append("<option>INFO</option>");o.append("<option>WARN</option>");o.append("<option>ERROR</option>");o.attr("disabled",isDisabled());o.val(n.LEVEL);var k;o.focus(function(){k=this.value}).change(function(){var q=this.value;divQuestion.html("<h4>Change "+m+" log level from "+k+" to "+q+'. Are you sure?</h4><input type="button" id="yes" value="Yes" /><input type="button" id="no" value="No" />');$.blockUI({message:divQuestion,css:{padding:"25px",backgroundColor:"#eee",width:"375px"}});$("input#yes").click(function(){blockUIBlack();var r=urlSetLogLevel+"&logger="+m+"&level="+q+"&callback=?";$.getJSON(r).done(function(s){notify("",m+": log level changed from "+k+" to "+q,"success");unblockUIBlack()}).fail(function(s){notify("",m+": problem changing log level from "+k+" to "+q,"warning");unblockUIBlack()})});$("input#no").click(function(){o.val(k);unblockUIBlack();return false})})})}blockUIBlack();var c=$("div#utilities");var b=$("div#internalDB");var a=$("div#scripts");var d=$("div#informations");c.fadeOut(fadeOutTime,function(){if(internalDBActive=="true"){b.empty().append('<a href="'+urlDBWebConsole+'" id="aDBConsole" target="_blank">Internal DB Console</a><hr width="95%">');b.addClass("palign");$("a#aDBConsole").button();if(userRoles!="admin"){$("a#aDBConsole").removeAttr("href")}}a.empty().append("<div class='tableCaption'><h2 class='palign'>Middleware loggers</h2></div>");$.getJSON(urlGetInfos).always(function(g){var f=$(g.RESPONSE.INFOS.LOGGERS);e(f,a);var h="<h2 class='palign'>System Informations</h2>";h+="<p class='palign' style='line-height:2'><b>Java Vendor: </b>"+g.RESPONSE.INFOS.JAVA_VENDOR+", <b>Version: </b>"+g.RESPONSE.INFOS.JAVA_VERSION+"<br>";h+="<b>Os Arch: </b>"+g.RESPONSE.INFOS.OS_ARCH+", <b>Name: </b>"+g.RESPONSE.INFOS.OS_NAME+", <b>Version: </b>"+g.RESPONSE.INFOS.OS_VERSION+"<br>";h+="<b>User Name: </b>"+g.RESPONSE.INFOS.USER_NAME+", <b>Country: </b>"+g.RESPONSE.INFOS.USER_COUNTRY+", <b>Language: </b>"+g.RESPONSE.INFOS.USER_LANGUAGE+", <b>Timezone: </b>"+g.RESPONSE.INFOS.USER_TIMEZONE+"<br>";h+="<b>VM Charset: </b>"+g.RESPONSE.INFOS.CHARSET+"<br>";h+="<b>VM max memory: </b>"+g.RESPONSE.INFOS.JVM_MAX_MEMORY+" MB<br>";h+="<b>VM total memory: </b>"+g.RESPONSE.INFOS.JVM_TOTAL_MEMORY+" MB<br>";h+="<b>VM free memory: </b>"+g.RESPONSE.INFOS.JVM_FREE_MEMORY+" MB<br>";h+="<b>VM available processors: </b>"+g.RESPONSE.INFOS.JVM_AVAILABLE_PROCESSORS+"<br>";h+="<b>VM io temp directory: </b>"+g.RESPONSE.INFOS.JVM_IO_TEMP_DIR+"</p>";d.empty().html(h);c.slideDown("fast",function(){unblockUIBlack()})})})}function tabs(a){if(typeof userRoles=="undefined"){userRoles=a}if(internalActiveMQActive=="false"){$("li#liactivemqqueues").remove();$("div#activemqqueues").remove();$("li#liactivemqtopics").remove();$("div#activemqtopics").remove()}$("div#tabs").tabs({heightStyle:"fill",activate:function(c,d){var e=$("div#tabs").tabs("option","active");var b=$("div#tabs ul>li a").eq(e).attr("href");if(b=="#integrations"){resetAccordion($("div#div_info_accordion"));createTree(null)}else{if(b=="#activemqqueues"){activemqQueuesList()}else{if(b=="#activemqtopics"){activemqTopicsList()}else{if(b=="#utilities"){utilities()}}}}}});if(userRoles!="admin"){$(".ui-tabs").css({border:"3px dashed red"})}}function contextMenu(){$("div#div_browser").contextmenu({delegate:".menu",menu:[{title:"empty"}],beforeOpen:function(e,f){var b=f.target.closest("span[camelcontext]");var d=b.attr("camelroute");var c=(typeof d=="undefined")?false:true;var a=isDisabled();if(!c){$(this).contextmenu("replaceMenu",[{title:"Manage",uiIcon:"ui-icon-gear",children:[{title:"Start",cmd:"start",uiIcon:"ui-icon-play",disabled:a},{title:"Suspend",cmd:"suspend",uiIcon:"ui-icon-pause",disabled:a},{title:"----"},{title:"Refresh Class Loader",cmd:"resetcl",uiIcon:"ui-icon-arrowrefresh-1-s",disabled:a}]},{title:"----"},{title:"Add route",cmd:"addroute",uiIcon:"ui-icon-plusthick",disabled:a}])}else{$(this).contextmenu("replaceMenu",[{title:"Start",cmd:"start",uiIcon:"ui-icon-play",disabled:a},{title:"Stop",cmd:"stop",uiIcon:"ui-icon-stop",disabled:a},{title:"----"},{title:"Erase statistics",cmd:"reset",uiIcon:"ui-icon-erase",disabled:a}])}},select:function(c,e){if(e.target.length>0){var a=e.target.closest("span[camelcontext]");var d=a.attr("camelcontext");var b=a.attr("camelroute");if(typeof b=="undefined"){if(e.cmd=="addroute"){addRouteXML(d)}else{startStopContext(d,e.cmd)}}else{if(e.cmd=="reset"){resetRoute(d,b)}else{startStopRoute(d,b,e.cmd)}}}}})}function validateContextName(a){var b=checkLength(a,"Context's name",5,40);b=b&&checkRegexp(a,/^([a-zA-Z])*$/,"Context name: a-z and A-Z");if(b){divQuestion.html("<h4>New Context "+a.val()+' will be added.<br/>Are you sure?</h4><input type="button" id="yes" value="Yes"/><input type="button" id="no" value="No"/>');$.blockUI({message:divQuestion,css:{padding:"25px",backgroundColor:"#eee",width:"375px"}});$("input#yes").click(function(){var c=urlAddContext+"&context="+a.val();$.getJSON(c).always(function(d){$("div#alert").dialog("close");createTree(null)})});$("input#no").click(function(){unblockUIBlack();return false})}}function inputUploadChange(){$("input#uploadButton").click()}function showContextDirectory(b){var c=$("p#contextDirectoryParagraph").empty().append("<div id='infoParagraphTree'></div>");c.fileTree({root:b,script:urlContextDirectory,expandSpeed:750,collapseSpeed:750,expandEasing:"easeOutBounce",collapseEasing:"easeOutBounce"},function(e){$.fileDownload(urlDownloadContextFile+e+"?key="+getKey(),{preparingMessageHtml:"Please wait ...",failMessageHtml:"There was a problem downloading the file, please try again."})});$("form#uploadFileForm").remove();var a="<form id='uploadFileForm' enctype='multipart/form-data' method='post'><label for='selectedFile' class='custom-file-selection'><i class='ui-icon ui-icon-upload'></i> Upload file</label>";a+="<input id='selectedFile' name='selectedFile' type='file' onchange='inputUploadChange();'><input id='uploadButton' type='submit'><div id='uploadStatus'></div></form>";var d=$(a).insertBefore("p#contextDirectoryParagraph");d.attr("action",baseUrl+"/manager/uploadContextFile");d.ajaxForm({data:{contextName:b},beforeSubmit:function(){$("div#uploadStatus").html("Uploading file ...")},success:function(f){var e=jQuery.parseJSON(f);$("div#uploadStatus").html(e.RESPONSE.DESCRIPTION);if(e.RESPONSE.STATUS==1){showContextDirectory(b)}}});contextMenuContextDirectory(b)}function contextMenuContextDirectory(b){var a=isDisabled();$("p#contextDirectoryParagraph").contextmenu({delegate:".menu",menu:[{title:"Delete",cmd:"deletecontextfile",uiIcon:"ui-icon-trash",disabled:a}],beforeOpen:function(e,f){var d=f.target.closest("a[rel]");var c=(typeof d=="undefined")?false:true;$(this).contextmenu("showEntry","deletecontextfile",c)},select:function(e,f){if(f.target.length>0){var c=f.target.closest("a[rel]");if(typeof c!=="undefined"&&f.cmd=="deletecontextfile"){var d=c.attr("rel");divQuestion.html("<h4>Remove file "+d+'.<br/>Are you sure?</h4><input type="button" id="yes" value="Yes" /><input type="button" id="no" value="No" />');$.blockUI({message:divQuestion,css:{padding:"25px",backgroundColor:"#eee",width:"375px"}});$("input#yes").click(function(){var g=urlRemoveContextFile+"&filePath="+d;$.getJSON(g).always(function(h){showContextDirectory(b);unblockUIBlack()})});$("input#no").click(function(){unblockUIBlack();return false})}}}})}function createTree(b){blockUIBlack();$("p#infoParagraph").empty();$("div#addContext").empty().append("<button title='Add context' id='btn-addcontext'>ac</button>");$("button#btn-addcontext").button({icons:{primary:"ui-icon-circle-plus"},text:false,disabled:isDisabled()}).click(function(d){blockUIBlack();var c=$("div#alert");c.dialog({autoOpen:false,closeOnEscape:true,position:{my:"top center",at:"top center",of:$("div#tabs")}});c.dialog({title:"Add context ",modal:true,draggable:false,resizable:false,height:$(window).height()*0.35,width:"35%",show:{effect:"scale",duration:500},hide:{effect:"scale",duration:1000}});c.html('<div id="dialog-form" title=""><p class="validateTips"></p><form><fieldset><label for="contextNL">Name</label><input type="text" name="contextNameN" id="contextNameId" class="text ui-widget-content ui-corner-all"></fieldset></form></div>');$("div#dialog-form label").css("display","block");$("div#dialog-form input").css({display:"block","margin-bottom":"12px",width:"95%",padding:".4em"});$("div#dialog-form .validateTips").css({border:"1px solid transparent",padding:"0.3em"});c.dialog({buttons:[{text:"Save",click:function(){validateContextName($("#contextNameId"))}}]});$(c).find("input#contextNameId").keypress(function(e){if(e.which==jQuery.ui.keyCode.ENTER){e.preventDefault();validateContextName($("#contextNameId"))}});c.dialog({close:function(e,f){unblockUIBlack()}});c.dialog({open:function(e,f){unblockUIBlack()}});c.dialog("open")});$("div#div_browser").html("<ul id='browser' class='filetree'></ul>");var a=$("div#div_browser>ul#browser");$.getJSON(urlTree).always(function(c){$.each($(c.RESPONSE.CONTEXT),function(l,e){a.append("<li id='"+e.NAME+"'>");var d=$(a).find("li#"+e.NAME);var k="folder";if(e.STATUS<1){k="folderstop"}var h="";var j=e.NAME;if(j.length>15){j=j.substring(0,16)+"...";h=e.NAME}var g="<span id='"+e.NAME+"Folder' class='"+k+" menu' camelcontext='"+e.NAME+"'>";g+="<label title='"+h+"'><b>"+j+"</b></label>";g+="&nbsp;<a href='#' id='"+e.NAME+"Info'>Info</a>";g+="<a href='#' id='"+e.NAME+"EDITPROPERTIES'>Edit properties</a>";g+="<a href='#' id='"+e.NAME+"EDITBEANS'>Edit beans</a>";g+="</span></li>";d.append(g);var f=$("a#"+e.NAME+"Info");f.button({icons:{primary:"ui-icon-info"},text:false}).click(function(){blockUIBlack();var n=$("div#div_info_accordion");resetAccordion(n);n.append('<h3 id="accordionInfoContext"><b>INFO:</b> '+e.NAME+"</h3>");n.append('<div id="div_infoParagraph"><p id="infoParagraph"><br></p></div>');n.append('<h3 id="accordionFileLogsContext"><b>FILE LOGS:</b> '+e.NAME+"</h3>");n.append('<div id="div_fileLogsParagraph"><p id="fileLogsParagraph"><br></p></div>');if(internalDBActive=="true"){n.append('<h3 id="accordionDBLogsContext"><b>DATABASE LOGS:</b> '+e.NAME+"</h3>");n.append('<div id="div_dbLogsParagraph"><p id="dbLogsParagraph"><br></p></div>')}n.append('<h3 id="accordionContextDirectory"><b>DIRECTORY:</b> '+e.NAME+"</h3>");n.append('<div id="div_contextDirectoryParagraph"><p id="contextDirectoryParagraph"><br></p></div>');n.append('<h3 id="accordionContextScripts"><b>SCRIPTS:</b> '+e.NAME+"</h3>");n.append('<div id="div_contextDirectoryParagraph"><p id="contextScriptsParagraph"><br></p></div>');n.accordion({collapsible:true,active:false,heightStyle:"panel"});n.on("accordionbeforeactivate",function(q,r){var s=r.oldHeader.attr("id");if(s=="accordionInfoContext"){$("p#infoParagraph").empty()}else{if(s=="accordionFileLogsContext"){$("p#fileLogsParagraph").empty()}else{if(s=="accordionDBLogsContext"){$("p#dbLogsParagraph").empty()}else{if(s=="accordionContextDirectory"){$("p#contextDirectoryParagraph").empty()}else{if(s=="accordionContextScripts"){$("p#contextScriptsParagraph").empty()}}}}}var v=r.newHeader.attr("id");if(v=="accordionInfoContext"){blockUIBlack();var u=urlContext+"&context="+e.NAME+"&callback=?";$.getJSON(u).always(function(w){createContextTable(w.CONTEXT);unblockUIBlack()})}else{if(v=="accordionFileLogsContext"){blockUIBlack();var p=urlContextLogsXml+"&context="+e.NAME+"&callback=?";$.getJSON(p).always(function(w){createContextLogsTable(w,{NAME:e.NAME});unblockUIBlack()})}else{if(v=="accordionDBLogsContext"){blockUIBlack();var o=urlContextDBLogs+"&context="+e.NAME+"&callback=?";$.getJSON(o).always(function(w){createContextDBLogsTable(w,{NAME:e.NAME});unblockUIBlack()})}else{if(v=="accordionContextDirectory"){blockUIBlack();showContextDirectory(e.NAME);unblockUIBlack()}else{if(v=="accordionContextScripts"){blockUIBlack();var t=urlScriptsList+"&context="+e.NAME+"&callback=?";$.getJSON(t).always(function(w){createScriptsListTable(w);unblockUIBlack()})}}}}}});unblockUIBlack()});f.css({height:"18px",width:"18px",background:"white",color:"silver"});var m=$("a#"+e.NAME+"EDITPROPERTIES");m.button({icons:{primary:"ui-icon-file-text"},text:false,disabled:isDisabled()}).click(function(){editContextProperties(e.NAME)});m.css({height:"18px",width:"18px",background:"white",color:"silver"});var i=$("a#"+e.NAME+"EDITBEANS");i.button({icons:{primary:"ui-icon-file-richtext"},text:false,disabled:isDisabled()}).click(function(){editBeans(e.NAME)});i.css({height:"18px",width:"18px",background:"white",color:"gray"});$.each($(e.ROUTE),function(t,u){var q=(u.ERRORS>0)?"orange":"green";var w="white";if(u.STATUS<1){q="gray";w="black"}var o=u.NAME.replace(/\./g,"_");var p="";var n=u.NAME;if(n.length>15){n=n.substring(0,16)+"...";p=u.NAME}var r="<ul><li><span id='"+e.NAME+o+"SPAN' class='menu file' camelcontext='"+e.NAME+"' camelroute='"+u.NAME+"'>";r+="<label title='"+p+"'>"+n+"</label>";r+="&nbsp;<a href='#' id='"+e.NAME+o+"INFO'>Info</a>";r+="<a href='#' id='"+e.NAME+o+"EDITROUTE'>Edit route</a>";r+="</span></li></ul>";d.append(r);var s=$("a#"+e.NAME+o+"INFO");s.button({icons:{primary:"ui-icon-info"},text:false}).click(function(){var y=$("div#div_info_accordion");resetAccordion(y);y.append('<h3 id="accordionInfoContext"><b>INFO:</b> '+e.NAME+"."+o+"</h3>");y.append('<div id="div_infoParagraph"><p id="infoParagraph"><br></p></div>');y.append('<h3 id="accordionFileLogsContext"><b>FILE LOGS:</b> '+e.NAME+"."+o+"</h3>");y.append('<div id="div_fileLogsParagraph"><p id="fileLogsParagraph"><br></p></div>');if(internalDBActive=="true"){y.append('<h3 id="accordionDBLogsContext"><b>DATABASE LOGS:</b> '+e.NAME+"."+o+"</h3>");y.append('<div id="div_dbLogsParagraph"><p id="dbLogsParagraph"><br></p></div>')}y.accordion({collapsible:true,active:false,heightStyle:"panel"});y.on("accordionbeforeactivate",function(C,D){var E=D.oldHeader.attr("id");if(E=="accordionInfoContext"){$("p#infoParagraph").empty()}else{if(E=="accordionFileLogsContext"){$("p#fileLogsParagraph").empty()}else{if(E=="accordionDBLogsContext"){$("p#dbLogsParagraph").empty()}}}var F=D.newHeader.attr("id");if(F=="accordionInfoContext"){blockUIBlack();var A=urlRoute+"&context="+e.NAME+"&route="+u.NAME+"&callback=?";$.getJSON(A).always(function(G){createRouteTable(G.ROUTE,e);unblockUIBlack()})}else{if(F=="accordionFileLogsContext"){blockUIBlack();var z=urlLogsXml+"&context="+e.NAME+"&route="+o+"&callback=?";$.getJSON(z).always(function(G){createRouteLogsTable(G,{NAME:e.NAME},{NAME:o});unblockUIBlack()})}else{if(F=="accordionDBLogsContext"){blockUIBlack();var B=urlRouteDBLogs+"&context="+e.NAME+"&route="+o+"&callback=?";$.getJSON(B).always(function(G){createDBLogsTable(G,{NAME:e.NAME},{NAME:o});unblockUIBlack()})}}}});blockUIBlack();var x=urlRoute+"&context="+e.NAME+"&route="+u.NAME+"&callback=?";$.getJSON(x).always(function(C){var B=parseInt(C.ROUTE.EXCHANGESFAILED)+parseInt(C.ROUTE.FAILURESHANDLED)+parseInt(C.ROUTE.DBERRORS);var A=(B>0)?"orange":"green";var z="white";if(C.ROUTE.STATUS<1){A="gray";z="black"}s.css({background:A,color:z});unblockUIBlack()})});s.css({height:"18px",width:"18px",background:q,color:w});var v=$("a#"+e.NAME+o+"EDITROUTE");v.button({icons:{primary:"ui-icon-edit"},text:false,disabled:isDisabled()}).click(function(){blockUIBlack();editRouteXML(e.NAME,o)});v.css({height:"18px",width:"18px",background:"white",color:"silver"})})});a.treeview({collapsed:true});$('[title!=""]').qtip({style:{tip:true,classes:"qtip-shadow qtip-rounded"},position:{target:"mouse",my:"bottom left",at:"top left"},show:{solo:true,delay:1000},hide:{distance:10}});contextMenu();unblockUIBlack();if(b!=null){b()}})}function init(){divQuestion=$("div#question");createTree(null)};